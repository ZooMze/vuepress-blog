<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>2020-Q3 技术分享与探讨 | ZooMze&#39;s World</title>
    <meta name="generator" content="VuePress 1.5.0">
    <link rel="icon" href="/vuepress-blog/favicon.ico">
    <meta name="description" content="Code your dream!">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    <link rel="preload" href="/vuepress-blog/assets/css/0.styles.6f95b769.css" as="style"><link rel="preload" href="/vuepress-blog/assets/js/app.08ec8abf.js" as="script"><link rel="preload" href="/vuepress-blog/assets/js/4.98f06f74.js" as="script"><link rel="preload" href="/vuepress-blog/assets/js/1.f7bebc45.js" as="script"><link rel="preload" href="/vuepress-blog/assets/js/43.f1f6284c.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/js/10.e545f867.js"><link rel="prefetch" href="/vuepress-blog/assets/js/11.700e9c7c.js"><link rel="prefetch" href="/vuepress-blog/assets/js/12.463bbefb.js"><link rel="prefetch" href="/vuepress-blog/assets/js/13.55b3a4b4.js"><link rel="prefetch" href="/vuepress-blog/assets/js/14.2ce287c6.js"><link rel="prefetch" href="/vuepress-blog/assets/js/15.c487e23b.js"><link rel="prefetch" href="/vuepress-blog/assets/js/16.5348eedf.js"><link rel="prefetch" href="/vuepress-blog/assets/js/17.272ab600.js"><link rel="prefetch" href="/vuepress-blog/assets/js/18.035ae0e2.js"><link rel="prefetch" href="/vuepress-blog/assets/js/19.29f02bf1.js"><link rel="prefetch" href="/vuepress-blog/assets/js/20.145fd3fb.js"><link rel="prefetch" href="/vuepress-blog/assets/js/21.d2352f77.js"><link rel="prefetch" href="/vuepress-blog/assets/js/22.8d719d54.js"><link rel="prefetch" href="/vuepress-blog/assets/js/23.810c886a.js"><link rel="prefetch" href="/vuepress-blog/assets/js/24.ef153a67.js"><link rel="prefetch" href="/vuepress-blog/assets/js/25.c45a3e93.js"><link rel="prefetch" href="/vuepress-blog/assets/js/26.a03a543c.js"><link rel="prefetch" href="/vuepress-blog/assets/js/27.8acf436f.js"><link rel="prefetch" href="/vuepress-blog/assets/js/28.8bf23c55.js"><link rel="prefetch" href="/vuepress-blog/assets/js/29.452ac1a0.js"><link rel="prefetch" href="/vuepress-blog/assets/js/30.739945eb.js"><link rel="prefetch" href="/vuepress-blog/assets/js/31.4af469a5.js"><link rel="prefetch" href="/vuepress-blog/assets/js/32.b64452db.js"><link rel="prefetch" href="/vuepress-blog/assets/js/33.11da4150.js"><link rel="prefetch" href="/vuepress-blog/assets/js/34.e080b716.js"><link rel="prefetch" href="/vuepress-blog/assets/js/35.6a5a98e6.js"><link rel="prefetch" href="/vuepress-blog/assets/js/36.32fe7d81.js"><link rel="prefetch" href="/vuepress-blog/assets/js/37.c273b5ad.js"><link rel="prefetch" href="/vuepress-blog/assets/js/38.dca5dd05.js"><link rel="prefetch" href="/vuepress-blog/assets/js/39.085ea94d.js"><link rel="prefetch" href="/vuepress-blog/assets/js/40.b53dd35f.js"><link rel="prefetch" href="/vuepress-blog/assets/js/41.859ba097.js"><link rel="prefetch" href="/vuepress-blog/assets/js/42.0e269f5a.js"><link rel="prefetch" href="/vuepress-blog/assets/js/44.031143f5.js"><link rel="prefetch" href="/vuepress-blog/assets/js/45.e3bcbbad.js"><link rel="prefetch" href="/vuepress-blog/assets/js/46.9a90643e.js"><link rel="prefetch" href="/vuepress-blog/assets/js/47.902ec5d5.js"><link rel="prefetch" href="/vuepress-blog/assets/js/48.92eb7159.js"><link rel="prefetch" href="/vuepress-blog/assets/js/49.d7d584c6.js"><link rel="prefetch" href="/vuepress-blog/assets/js/5.90927284.js"><link rel="prefetch" href="/vuepress-blog/assets/js/50.95c0f153.js"><link rel="prefetch" href="/vuepress-blog/assets/js/51.fb8a6800.js"><link rel="prefetch" href="/vuepress-blog/assets/js/52.fc33693e.js"><link rel="prefetch" href="/vuepress-blog/assets/js/53.dc66da3b.js"><link rel="prefetch" href="/vuepress-blog/assets/js/6.0964f437.js"><link rel="prefetch" href="/vuepress-blog/assets/js/7.fc1177d9.js"><link rel="prefetch" href="/vuepress-blog/assets/js/8.9b0b183f.js"><link rel="prefetch" href="/vuepress-blog/assets/js/9.c0ad6d4b.js"><link rel="prefetch" href="/vuepress-blog/assets/js/vendors~flowchart.88969470.js">
    <link rel="stylesheet" href="/vuepress-blog/assets/css/0.styles.6f95b769.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container" data-v-19557b78><div data-v-19557b78><div id="loader-wrapper" class="loading-wrapper" data-v-d48f4d20 data-v-19557b78 data-v-19557b78><div class="loader-main" data-v-d48f4d20><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div></div> <!----> <!----></div> <div class="password-shadow password-wrapper-out" style="display:none;" data-v-64685f0e data-v-19557b78 data-v-19557b78><h3 class="title" style="display:none;" data-v-64685f0e data-v-64685f0e>ZooMze's World</h3> <!----> <label id="box" class="inputBox" style="display:none;" data-v-64685f0e data-v-64685f0e><input type="password" value="" data-v-64685f0e> <span data-v-64685f0e>Konck! Knock!</span> <button data-v-64685f0e>OK</button></label> <div class="footer" style="display:none;" data-v-64685f0e data-v-64685f0e><span data-v-64685f0e><i class="iconfont reco-theme" data-v-64685f0e></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-64685f0e>vuePress-theme-reco</a></span> <span data-v-64685f0e><i class="iconfont reco-copyright" data-v-64685f0e></i> <a data-v-64685f0e><span data-v-64685f0e>ZooMze</span>
            
          <span data-v-64685f0e>2018 - </span>
          2021
        </a></span></div></div> <div class="hide" data-v-19557b78><header class="navbar" data-v-19557b78><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/vuepress-blog/" class="home-link router-link-active"><img src="/vuepress-blog/logo.png" alt="ZooMze's World" class="logo"> <span class="site-name">ZooMze's World</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/vuepress-blog/" class="nav-link"><i class="iconfont reco-home"></i>
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      分类
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vuepress-blog/categories/基础/" class="nav-link"><i class="iconfont undefined"></i>
  基础
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/categories/备忘/" class="nav-link"><i class="iconfont undefined"></i>
  备忘
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/categories/教程/" class="nav-link"><i class="iconfont undefined"></i>
  教程
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/categories/扩展/" class="nav-link"><i class="iconfont undefined"></i>
  扩展
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/categories/框架/" class="nav-link"><i class="iconfont undefined"></i>
  框架
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/categories/组件/" class="nav-link"><i class="iconfont undefined"></i>
  组件
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/categories/季度分享/" class="nav-link"><i class="iconfont undefined"></i>
  季度分享
</a></li></ul></div></div><div class="nav-item"><a href="/vuepress-blog/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  标签
</a></div><div class="nav-item"><a href="/vuepress-blog/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  时光轴
</a></div><div class="nav-item"><a href="https://github.com/ZooMze" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-19557b78></div> <aside class="sidebar" data-v-19557b78><div class="personal-info-wrapper" data-v-042e23d4><img src="/vuepress-blog/avatar.png" alt="author-avatar" class="personal-img" data-v-042e23d4> <h3 class="name" data-v-042e23d4>
    ZooMze
  </h3> <div class="num" data-v-042e23d4><div data-v-042e23d4><h3 data-v-042e23d4>35</h3> <h6 data-v-042e23d4>Article</h6></div> <div data-v-042e23d4><h3 data-v-042e23d4>23</h3> <h6 data-v-042e23d4>Tag</h6></div></div> <hr data-v-042e23d4></div> <nav class="nav-links"><div class="nav-item"><a href="/vuepress-blog/" class="nav-link"><i class="iconfont reco-home"></i>
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      分类
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vuepress-blog/categories/基础/" class="nav-link"><i class="iconfont undefined"></i>
  基础
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/categories/备忘/" class="nav-link"><i class="iconfont undefined"></i>
  备忘
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/categories/教程/" class="nav-link"><i class="iconfont undefined"></i>
  教程
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/categories/扩展/" class="nav-link"><i class="iconfont undefined"></i>
  扩展
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/categories/框架/" class="nav-link"><i class="iconfont undefined"></i>
  框架
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/categories/组件/" class="nav-link"><i class="iconfont undefined"></i>
  组件
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/categories/季度分享/" class="nav-link"><i class="iconfont undefined"></i>
  季度分享
</a></li></ul></div></div><div class="nav-item"><a href="/vuepress-blog/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  标签
</a></div><div class="nav-item"><a href="/vuepress-blog/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  时光轴
</a></div><div class="nav-item"><a href="https://github.com/ZooMze" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>2020-Q3 技术分享与探讨</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/vuepress-blog/views/summary/2020-Q3.html#小程序的原生组件渲染层级的问题" class="sidebar-link">小程序的原生组件渲染层级的问题</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuepress-blog/views/summary/2020-Q3.html#小程序的storage的问题" class="sidebar-link">小程序的Storage的问题</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuepress-blog/views/summary/2020-Q3.html#小程序流媒体播放" class="sidebar-link">小程序流媒体播放</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuepress-blog/views/summary/2020-Q3.html#小程序的列表与详情相关交互" class="sidebar-link">小程序的列表与详情相关交互</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuepress-blog/views/summary/2020-Q3.html#修改状态" class="sidebar-link">修改状态</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/views/summary/2020-Q3.html#删除条目" class="sidebar-link">删除条目</a></li></ul></li><li><a href="/vuepress-blog/views/summary/2020-Q3.html#自己的cdn" class="sidebar-link">自己的CDN</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuepress-blog/views/summary/2020-Q3.html#ws代理" class="sidebar-link">ws代理</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuepress-blog/views/summary/2020-Q3.html#更加统一的日期" class="sidebar-link">更加统一的日期</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuepress-blog/views/summary/2020-Q3.html#date-format" class="sidebar-link">Date.Format</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/views/summary/2020-Q3.html#intl" class="sidebar-link">Intl</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/views/summary/2020-Q3.html#temporal" class="sidebar-link">Temporal</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/views/summary/2020-Q3.html#第三方库" class="sidebar-link">第三方库</a></li></ul></li><li><a href="/vuepress-blog/views/summary/2020-Q3.html#小程序规范" class="sidebar-link">小程序规范</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuepress-blog/views/summary/2020-Q3.html#element" class="sidebar-link">Element+</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuepress-blog/views/summary/2020-Q3.html#如何让强制浏览器不自动填充账号密码" class="sidebar-link">如何让强制浏览器不自动填充账号密码</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-64685f0e data-v-19557b78><h3 class="title" style="display:none;" data-v-64685f0e data-v-64685f0e>2020-Q3 技术分享与探讨</h3> <!----> <label id="box" class="inputBox" style="display:none;" data-v-64685f0e data-v-64685f0e><input type="password" value="" data-v-64685f0e> <span data-v-64685f0e>Konck! Knock!</span> <button data-v-64685f0e>OK</button></label> <div class="footer" style="display:none;" data-v-64685f0e data-v-64685f0e><span data-v-64685f0e><i class="iconfont reco-theme" data-v-64685f0e></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-64685f0e>vuePress-theme-reco</a></span> <span data-v-64685f0e><i class="iconfont reco-copyright" data-v-64685f0e></i> <a data-v-64685f0e><span data-v-64685f0e>ZooMze</span>
            
          <span data-v-64685f0e>2018 - </span>
          2021
        </a></span></div></div> <div data-v-19557b78><main class="page"><div class="page-title" style="display:none;"><h1>2020-Q3 技术分享与探讨</h1> <hr> <div data-v-34ea29db><i class="iconfont reco-account" data-v-34ea29db><span data-v-34ea29db>ZooMze</span></i> <i class="iconfont reco-date" data-v-34ea29db><span data-v-34ea29db>2020-12-01</span></i> <i class="iconfont reco-eye" data-v-34ea29db><span id="/vuepress-blog/views/summary/2020-Q3.html" data-flag-title="Your Article Title" class="leancloud-visitors" data-v-34ea29db><a class="leancloud-visitors-count" style="font-size:.9rem;font-weight:normal;color:#999;"></a></span></i> <!----></div></div> <div class="theme-reco-content content__default" style="display:none;"><h2 id="小程序的原生组件渲染层级的问题"><a href="#小程序的原生组件渲染层级的问题" class="header-anchor">#</a> 小程序的原生组件渲染层级的问题</h2> <p>小程序中有的组件是由原生的方式进行渲染的, 例如图表、picker-view, 它们的层级是绝对高于普通的页面元素, 无论在普通页面元素中使用多高的 <code>z-index</code> 属性也无法超过这些原生组件的层级</p> <div class="custom-block tip"><p class="custom-block-title">疑惑</p> <p>在开发者工具中调试时, 确实会出现上述图表层级超越页面元素的问题, 但是实际测试时, 在大多数手机中此层级问题却不是必现问题</p></div> <p>为了解决这个穿透的问题, 尝试使用了 <code>cover-view</code> 组件, 它同样由原生组件渲染, 所以它的层级可以超越图表, 按照官方文档的理论如此, 但实际在明厨亮灶小程序中却没有一处改写为 <code>cover-view</code> 生效的内容, 原因可能是由于渲染先后的关系, 导致导航处的 <code>cover-view</code> 仍然无法覆盖页面内的图表显示层级, 及时按照文档修改了 <code>z-index</code> 的属性依旧无法覆盖</p> <p>最终的解决方案为弹出日历picker时将图表内容隐藏, 用其余占位内容保证页面不出现变化, 让用户尽量无感知, 但这个方案仍然有问题, 即图表滑动到页面顶部时时会覆盖掉顶部的自定义导航(目前这个自定义导航使用的是第三方插件, 并非使用了<code>cover-view</code>), 短时间内无法完美适配</p> <p>以后的小程序在开发前就要注意到这个<strong>原生组件的渲染层级问题</strong></p> <p>uni-app中的层级说明: <a href="https://uniapp.dcloud.io/component/native-component" target="_blank" rel="noopener noreferrer">uni-app原生组件说明<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>
wx-weapp的cover-view: <a href="https://developers.weixin.qq.com/miniprogram/dev/component/cover-view.html" target="_blank" rel="noopener noreferrer">微信官方文档cover-view的说明<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="小程序的storage的问题"><a href="#小程序的storage的问题" class="header-anchor">#</a> 小程序的Storage的问题</h2> <p>小程序在获取getStorageSync时可能会遇到无法获取到值的问题, 这个问题在切出小程序再次回到小程序时稳定重现, 可能会导致数据丢失进而影响功能</p> <p>为了解决以及避免问题再现, 应该将所有需要的数据在created/mounted时, 先将数据存储在组件内, 则不会丢失数据</p> <h2 id="小程序流媒体播放"><a href="#小程序流媒体播放" class="header-anchor">#</a> 小程序流媒体播放</h2> <p>小程序支持内置的流媒体播放方案: 但仅支持两种格式的流: <code>.flv</code> 和 <code>.rtmp</code>;</p> <p>同时并非直接使用video标签, 而是使用 <code>&lt;live-player&gt;</code> 标签, 它与传统的 <code>&lt;video&gt;</code> 不同, 内置的内容比video少很多, 甚至全屏功能也不能直接在标签内设置属性控制;</p> <p>需要控制全屏功能时需要先使用 <code>createLivePlayerContext()</code> 获取 <code>&lt;live-player&gt;</code> 的实例, 然后再调用 <code>requestFullScreen()</code> 这个API, 并在成功 <code>success</code> 和失败 <code>fail</code> 回调中处理你的代码逻辑</p> <p>同时全屏后的内容例如退出全屏按钮, 返回按钮等, 都需要写在 <code>&lt;live-player&gt;</code> 标签内部, 最好是使用 <code>&lt;cover-view&gt;</code> 和<code>&lt;cover-image&gt;</code>, 并设置较高层级, 以防止这些内容被视频内容遮挡(即上面的层级问题)</p> <h2 id="小程序的列表与详情相关交互"><a href="#小程序的列表与详情相关交互" class="header-anchor">#</a> 小程序的列表与详情相关交互</h2> <p>在移动页面中, 通常是不会出现类似pc上的<code>dialog</code>窗口交互的模式, 通常详情即是一个全新的页面(detail page), 在新页面中还会附带一些影响列表页(list page)的操作, 例如修改状态, 删除条目等</p> <p>小程序的页面跳转逻辑类似keep-alive, 进入详情页时, 列表页内容将会全部缓存, 这就导致详情页的操作将会影响列表页, 回到列表页直接刷新整个列表将会非常臃肿, 而且让用户回到上次浏览位置也需要记录页码 <code>pageNo</code> 和高度 <code>scrollHeight</code> 信息, 相比恶心的高度计算, 记录当条记录的 <code>id</code> 和 <code>index</code> 就显得非常直观和简单</p> <h3 id="修改状态"><a href="#修改状态" class="header-anchor">#</a> 修改状态</h3> <p>修改状态时, 返回列表只刷新对应的条目, 此时只需要只需记录其 <code>id</code> 和 <code>pageNo</code>, 当回到列表页时只需<strong>重新获取</strong>这一页的数据, 再比对 <code>id</code> 后更新列表对应的条目即可</p> <div class="custom-block warning"><p class="custom-block-title">注意</p> <p>注意此时重新获取时, 不仅要重新附带当前的全部筛选条件, 还可能会由于数据更新导致本应处于第n页的数据被挤到了第n页后, 为了再次查询到目标条目所以此时<code>pageSize</code>应该被适当放大, 根据这个列表的更新频率来决定 <code>pageSize</code> 应该放到多大</p></div> <h3 id="删除条目"><a href="#删除条目" class="header-anchor">#</a> 删除条目</h3> <p>删除(或者说是操作导致列表在当前筛选条件下消失), 此时记录 <code>index</code> 和 <code>pageNo</code>, 返回列表时将对应条目删除</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">delete</span> listData<span class="token punctuation">[</span>index<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>虽然这里是假删除, 但是也不用在意这么做的风险性, 因为这是详情页的处理成功回调后续, 这里删除肯定是不会产生错误的, 除非服务端错误...</p> <h2 id="自己的cdn"><a href="#自己的cdn" class="header-anchor">#</a> 自己的CDN</h2> <p>明厨亮灶云平台中的富文本功能中使用了tinymce.js, 并且使用了通过url进行加载的方法, url为挂在jsDELIVER的CDN, 但是这个CDN并非国内CDN且不稳定, 导致目前经常会出现富文本加载失败的情况, 因此结合实际和公司内已有的服务器资源, 将同版本的tinymce存放在公司的阿里服务器中, 初次实践时发现js能加载成功, 但是字体图表全部无法成功加载, 浏览器报跨域错误, 最后在阿里服务器中配置了可访问网址白名单即解决</p> <h2 id="ws代理"><a href="#ws代理" class="header-anchor">#</a> ws代理</h2> <p>在现有项目中, 获取流视频为通常的ws服务器配置代理, 在本地项目中配置代理时可以直接地址为ws/wss, 但NGINX目前无法直接配置这种代理, 配置的地址依然需要http/https, 并将其升级为websocket</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>location /httpurl/ <span class="token punctuation">{</span>
  proxy_pass http://wsbackendurl<span class="token punctuation">;</span>
  proxy_http_version <span class="token number">1.1</span><span class="token punctuation">;</span>
  proxy_set_header Upgrade <span class="token variable">$http_upgrade</span><span class="token punctuation">;</span>
  proxy_set_header Connection <span class="token string">&quot;upgrade&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="更加统一的日期"><a href="#更加统一的日期" class="header-anchor">#</a> 更加统一的日期</h2> <p>由泛华航空园区项目引发的思考, 在页面间跳转时, 时间控件的不统一导致了不少麻烦事, 为了避免类似的问题再次发生, 日期的相关内容需要更加规范化: 例如时间控件的统一, 全局时间格式化方式的统一等</p> <p>时间控件的统一需要开发与产品一同协商, 属于不完全由开发掌控的问题, 但是时间格式化可以完全由开发决定(当然也涵盖前后台的时间参数传递之间的统一), 以下有几种思路</p> <h3 id="date-format"><a href="#date-format" class="header-anchor">#</a> Date.Format</h3> <p>传统的格式化方法, 但是通常都需要修改 <code>Date</code> 对象的构造函数, 格式化代码一搜一大堆→_→</p> <p>通常情况下不建议这么做, 因为不排除使用的某个第三方库也去修改了 <code>Date</code> 原型上的函数, 从而导致一些不必要的bug</p> <h3 id="intl"><a href="#intl" class="header-anchor">#</a> Intl</h3> <p><code>Intl</code> 对象是 ECMAScript 国际化 API 的一个命名空间，它提供了精确的字符串对比、数字格式化，和日期时间格式化。<code>Collator</code>，<code>NumberFormat</code> 和 <code>DateTimeFormat</code> 对象的构造函数是 <code>Intl</code> 对象的属性。</p> <h3 id="temporal"><a href="#temporal" class="header-anchor">#</a> Temporal</h3> <p><code>Temporal</code> 也是一个实验性的方案, 但目前支持度不高, 属于未来可期型</p> <h3 id="第三方库"><a href="#第三方库" class="header-anchor">#</a> 第三方库</h3> <p>时间相关组件库中, <a href="http://momentjs.cn/" target="_blank" rel="noopener noreferrer">Moment.js<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 是最全面最历史悠久的库, 随着时间的迭代其包体积对于一个时间库来说已经比较大了(2.24.0.min ~ 16kb), 但是实际项目中可能就使用了一些format之类的API, 实属有点小题大做, 同时还存在一个根本的问题: 其对象是可变的, 意味着为了避免多个时间干扰, 都需要进行克隆<code>.clone()</code>;</p> <p><s>目前momentjs已经停止开发, 进入维护阶段了</s></p> <p><a href="https://dayjs.gitee.io/zh-CN/" target="_blank" rel="noopener noreferrer">Day.js<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>就是更加合适的库, 它拥有极小的体积( ~ 2kb), 以及与moment.js近乎一致的体验, 而且解决了上述可变对象的问题, 每次调用结果都是全新的对象</p> <h2 id="小程序规范"><a href="#小程序规范" class="header-anchor">#</a> 小程序规范</h2> <p>项目或产品中需要小程序时, 不仅开发要遵守小程序的开发规范, 产品角度也需要遵守小程序的规范</p> <p><a href="https://developers.weixin.qq.com/miniprogram/product/reject.html#_3-1-%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%9F%BA%E6%9C%AC%E5%8A%9F%E8%83%BD%E5%AE%A1%E6%A0%B8%E8%A7%84%E8%8C%83" target="_blank" rel="noopener noreferrer">小程序整体审核规则<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>避免如上出现的问题会让小程序的迷之审核通过率大大提高...</p> <p>同时小程序以后的方向需要原生小程序进行, 虽然跟通常的web-vue应用开发模式不同, 但有着官方更好的支持、更多踩过的坑以及更官方的社区</p> <h2 id="element"><a href="#element" class="header-anchor">#</a> Element+</h2> <p>2020-11-30日, 下一代的element+ beta版发布了, 开发者称: &quot;以vue3的方式几乎重写了element的每一行代码&quot;, 将来项目中使用vue3开发项目时, 这将是一个很好的选择</p> <p><s>目前vue3的官中文档加载还是非常龟速</s></p> <h2 id="如何让强制浏览器不自动填充账号密码"><a href="#如何让强制浏览器不自动填充账号密码" class="header-anchor">#</a> 如何让强制浏览器不自动填充账号密码</h2> <p>目前只找到了一种较为可行的方法, 即在input前重复添加一个假的input内容来骗浏览器的自动填充, 但目前对于这种方式仅仅能完美拦截账号的填充, 密码的自动填充即使加上了<code>autocomplete='off'</code>, 浏览器仍然会在你以保存的密码中进行自动选择, 应该是浏览器的自动识别 <code>type='password'</code> 导致的</p></div> <footer class="page-edit" style="display:none;"><!----> <!----></footer> <!----> <!----></main> <!----></div></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-c6073ba8 data-v-c6073ba8><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-c6073ba8><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-c6073ba8></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-c6073ba8></path></svg></div><div id="live2d-widget" class="live2d-widget-container" style="position:fixed;right:65px;bottom:0px;width:130px;height:290px;z-index:99999;opacity:0.8;pointer-events:none;"><canvas id="live2d_canvas" width="130" height="290" class="live2d_canvas" style="position:absolute;left:0px;top:0px;width:130px;height:290px;"></canvas></div></div></div>
    <script src="/vuepress-blog/assets/js/app.08ec8abf.js" defer></script><script src="/vuepress-blog/assets/js/4.98f06f74.js" defer></script><script src="/vuepress-blog/assets/js/1.f7bebc45.js" defer></script><script src="/vuepress-blog/assets/js/43.f1f6284c.js" defer></script>
  </body>
</html>
